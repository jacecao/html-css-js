<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>前端路由控制-首页</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">
	<style>
		header{ text-align: center; padding-left: 4rem;}
	</style>
</head>
<body>
	<header>
		<nav class="breadcrumb" aria-label="breadcrumbs">
			<ul id="navbar">
				<li class="is-active"><a href="/index">首页</a></li>
				<li><a href="/news">新闻</a></li>
				<li><a href="/about">关于</a></li>
			</ul>
		</nav>
	</header>
	
	<section class="hero is-primary">
	  <div class="hero-body">
	    <div class="container">
	      <h1 class="title" id="text1">
	        This is index
	      </h1>
	      <h2 class="subtitle" id="text2">
	        home page
	      </h2>
	    </div>
	  </div>
	  
	  <pre>
	  	
	  </pre>
	</section>

	<script>

		// locationURI
		var getContent = function (query) {
			let pathName = '';
			if (query) {
				pathName = query.slice(1);
			} else {
				pathName = (window.location.pathname).slice(1);
				// 改变按钮状态
				let links = document.querySelectorAll('li');
				Array.prototype.forEach.call(links, function (link) {
					link.classList.remove('is-active');
					let _pathname = window.location.pathname == '/' ? '/index' : window.location.pathname;
					let _a = link.firstElementChild;
					if (_a.getAttribute('href') == _pathname) {
						link.classList.add('is-active');
					}
				});
			}
			let title = new String();

			// 改变内容
			let text1 = document.querySelector('#text1');
			let text2 = document.querySelector('#text2');

			switch (pathName) {
				case '':
				case 'index':
					title = '前端路由控制-首页';
					text1.innerHTML = '这是首页';
					text2.innerHTML = 'this is index page';
					break;
				case 'news':
					title = '前端路由控制-新闻';
					text1.innerHTML = '这是新闻页';
					text2.innerHTML = 'this is news page';
					break;
				case 'about':
					title = '前端路由控制-关于';
					text1.innerHTML = '这是关于页';
					text2.innerHTML = 'this is about page';
					break;		
			}
			document.title = title;

			history.pushState({title: title}, title, '/' + pathName);
		}

		let navbar = document.querySelector('#navbar');
		
		navbar.addEventListener('click', function (e) {
			e.preventDefault();
			if (e.target.nodeName.toLowerCase() == 'a') {
				// 改变按钮状态
				let links = document.querySelectorAll('li');
				Array.prototype.forEach.call(links, function (link) {
					link.classList.remove('is-active');
				});
				e.target.parentNode.classList.add('is-active');

				getContent(e.target.getAttribute('href'));
				// console.log(e.target.getAttribute('href'));
				// console.log(e.target.href);
			}
		}, false);

		getContent();

		// 这里是指当网页前进和后退时触发地址和页面数据更新
		window.addEventListener("popstate", function(e){
			console.log(e);
			getContent();
		}, false);
	</script>
</body>
</html>